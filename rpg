var gameData = {
    players: [],
    items: [],
    quests: [],
    monsters: [],
    bosses: [],
    skills: [],
    dungeons: []
};

function addPlayer(name) {
    var existingPlayer = getPlayer(name);
    if (existingPlayer) {
        return existingPlayer;
    }
    var newPlayer = {
        name: name,
        level: 1,
        exp: 0,
        maxHp: 100,
        hp: 100,
        mp: 50,
        maxMp: 50,
        attack: 10,
        defense: 5,
        gold: 0,
        inventory: [],
        equipment: {
            weapon: null,
            armor: null,
            accessory: null
        },
        skills: [],
        completedQuests: []
    };
    gameData.players.push(newPlayer);
    return newPlayer;
}

function getPlayer(name) {
    return gameData.players.find(function(p) { return p.name === name; });
}

function addItem(name, description, effect, type) {
    var newItem = {
        name: name,
        description: description,
        effect: effect,
        type: type
    };
    gameData.items.push(newItem);
    return newItem;
}

function addMonster(name, hp, attack, defense, expReward, goldReward) {
    var newMonster = {
        name: name,
        hp: hp,
        attack: attack,
        defense: defense,
        expReward: expReward,
        goldReward: goldReward
    };
    gameData.monsters.push(newMonster);
    return newMonster;
}

function addBoss(name, hp, attack, defense, expReward, goldReward, specialAbility, specialWeapon) {
    var newBoss = {
        name: name,
        hp: hp,
        attack: attack,
        defense: defense,
        expReward: expReward,
        goldReward: goldReward,
        specialAbility: specialAbility,
        specialWeapon: specialWeapon
    };
    gameData.bosses.push(newBoss);
    return newBoss;
}

function addQuest(title, description, rewardExp, rewardGold, requiredLevel, requiredKills) {
    var newQuest = {
        title: title,
        description: description,
        rewardExp: rewardExp,
        rewardGold: rewardGold,
        requiredLevel: requiredLevel,
        requiredKills: requiredKills
    };
    gameData.quests.push(newQuest);
    return newQuest;
}

function addSkill(name, description, mpCost, damage, type) {
    var newSkill = {
        name: name,
        description: description,
        mpCost: mpCost,
        damage: damage,
        type: type
    };
    gameData.skills.push(newSkill);
    return newSkill;
}

function levelUp(player) {
    player.level++;
    player.maxHp += 20;
    player.hp = player.maxHp;
    player.maxMp += 10;
    player.mp = player.maxMp;
    player.attack += 5;
    player.defense += 2;
}

function gainExp(player, exp) {
    player.exp += exp;
    while (player.exp >= player.level * 100) {
        player.exp -= player.level * 100;
        levelUp(player);
    }
}

function buyItem(player, itemName) {
    var item = gameData.items.find(function(i) { return i.name === itemName; });
    if (item && player.gold >= item.effect.price) {
        player.gold -= item.effect.price;
        player.inventory.push(item);
        return true;
    }
    return false;
}

function useItem(player, itemName) {
    var itemIndex = player.inventory.findIndex(function(i) { return i.name === itemName; });
    if (itemIndex !== -1) {
        var item = player.inventory[itemIndex];
        if (item.effect.heal) {
            player.hp = Math.min(player.maxHp, player.hp + item.effect.heal);
        }
        if (item.effect.mpRestore) {
            player.mp = Math.min(player.maxMp, player.mp + item.effect.mpRestore);
        }
        if (item.effect.attackBoost) {
            player.attack += item.effect.attackBoost;
        }
        if (item.effect.defenseBoost) {
            player.defense += item.effect.defenseBoost;
        }
        player.inventory.splice(itemIndex, 1);
        return true;
    }
    return false;
}

function equipItem(player, itemName) {
    var item = player.inventory.find(function(i) { return i.name === itemName; });
    if (item && (item.type === 'weapon' || item.type === 'armor' || item.type === 'accessory')) {
        if (player.equipment[item.type]) {
            unequipItem(player, item.type);
        }
        player.equipment[item.type] = item;
        player.inventory = player.inventory.filter(function(i) { return i.name !== itemName; });
        if (item.effect.attackBoost) player.attack += item.effect.attackBoost;
        if (item.effect.defenseBoost) player.defense += item.effect.defenseBoost;
        return true;
    }
    return false;
}

function unequipItem(player, itemType) {
    if (player.equipment[itemType]) {
        var item = player.equipment[itemType];
        player.inventory.push(item);
        if (item.effect.attackBoost) player.attack -= item.effect.attackBoost;
        if (item.effect.defenseBoost) player.defense -= item.effect.defenseBoost;
        player.equipment[itemType] = null;
        return true;
    }
    return false;
}

function learnSkill(player, skillName) {
    var skill = gameData.skills.find(function(s) { return s.name === skillName; });
    if (skill && !player.skills.some(function(s) { return s.name === skillName; })) {
        player.skills.push(skill);
        return true;
    }
    return false;
}

function useSkill(player, skillName, target) {
    var skill = player.skills.find(function(s) { return s.name === skillName; });
    if (skill && player.mp >= skill.mpCost) {
        player.mp -= skill.mpCost;
        var damage = skill.damage;
        if (skill.type === 'magic') {
            damage += Math.floor(player.level * 0.5);
        }
        if (skill.type === 'heal') {
            player.hp = Math.min(player.maxHp, player.hp - damage);
            return -damage;
        } else {
            target.hp -= Math.max(0, damage - target.defense);
            return damage;
        }
    }
    return 0;
}

function battle(player, enemyName, isBoss) {
    var enemy = isBoss ? 
        gameData.bosses.find(function(b) { return b.name === enemyName; }) :
        gameData.monsters.find(function(m) { return m.name === enemyName; });
    if (!enemy) return "ì ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";

    var enemyHp = enemy.hp;
    var battleLog = "âš”ï¸ " + player.name + "ì™€ " + enemy.name + "ì˜ ì „íˆ¬ ì‹œì‘! âš”ï¸\n";

    while (player.hp > 0 && enemyHp > 0) {
        // í”Œë ˆì´ì–´ í„´
        battleLog += "\nğŸ§™ " + player.name + "ì˜ í„´!\n";
        var action = Math.random() < 0.7 ? "attack" : "skill";
        if (action === "attack") {
            var playerDamage = Math.max(0, player.attack - enemy.defense);
            enemyHp -= playerDamage;
            battleLog += "ğŸ—¡ï¸ " + player.name + "ì˜ ê³µê²©! " + enemy.name + "ì—ê²Œ " + playerDamage + "ì˜ ë°ë¯¸ì§€ë¥¼ ì…í˜”ìŠµë‹ˆë‹¤.\n";
        } else if (player.skills.length > 0) {
            var randomSkill = player.skills[Math.floor(Math.random() * player.skills.length)];
            var skillDamage = useSkill(player, randomSkill.name, enemy);
            if (skillDamage !== 0) {
                if (skillDamage < 0) {
                    battleLog += "âœ¨ " + player.name + "ì˜ " + randomSkill.name + "! HPë¥¼ " + (-skillDamage) + " íšŒë³µí–ˆìŠµë‹ˆë‹¤.\n";
                } else {
                    enemyHp -= skillDamage;
                    battleLog += "âœ¨ " + player.name + "ì˜ " + randomSkill.name + "! " + enemy.name + "ì—ê²Œ " + skillDamage + "ì˜ ë°ë¯¸ì§€ë¥¼ ì…í˜”ìŠµë‹ˆë‹¤.\n";
                }
            } else {
                battleLog += "ğŸ˜“ MPê°€ ë¶€ì¡±í•˜ì—¬ ìŠ¤í‚¬ ì‚¬ìš©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n";
            }
        }

        if (enemyHp <= 0) break;

        // ì  í„´
        battleLog += "\nğŸ‘¹ " + enemy.name + "ì˜ í„´!\n";
        var enemyDamage = Math.max(0, enemy.attack - player.defense);
        player.hp -= enemyDamage;
        battleLog += "ğŸ’¥ " + enemy.name + "ì˜ ê³µê²©! " + player.name + "ì—ê²Œ " + enemyDamage + "ì˜ ë°ë¯¸ì§€ë¥¼ ì…í˜”ìŠµë‹ˆë‹¤.\n";

        if (isBoss && enemy.specialAbility && Math.random() < 0.3) {
            var specialDamage = Math.floor(enemy.attack * 1.5);
            player.hp -= specialDamage;
            battleLog += "ğŸŒŸ " + enemy.name + "ì˜ íŠ¹ìˆ˜ ëŠ¥ë ¥ " + enemy.specialAbility + "! " + player.name + "ì—ê²Œ " + specialDamage + "ì˜ ë°ë¯¸ì§€ë¥¼ ì…í˜”ìŠµë‹ˆë‹¤.\n";
        }
    }

    if (player.hp > 0) {
        battleLog += "\nğŸ‰ " + player.name + "ê°€ ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤!\n";
        player.gold += enemy.goldReward;
        gainExp(player, enemy.expReward);
        battleLog += "ğŸ’° " + enemy.expReward + "ì˜ ê²½í—˜ì¹˜ì™€ " + enemy.goldReward + "ê³¨ë“œë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤.\n";
        battleLog += "í˜„ì¬ ë ˆë²¨: " + player.level + ", ê²½í—˜ì¹˜: " + player.exp + "/" + (player.level * 100) + "\n";

        if (isBoss && enemy.specialWeapon) {
            var weaponDropChance = Math.random();
            if (weaponDropChance < 0.3) {  // 30% í™•ë¥ ë¡œ ë¬´ê¸° ë“œë¡­
                player.inventory.push(enemy.specialWeapon);
                battleLog += "ğŸ ì¶•í•˜í•©ë‹ˆë‹¤! " + enemy.name + "ì—ê²Œì„œ " + enemy.specialWeapon.name + "ì„(ë¥¼) íšë“í–ˆìŠµë‹ˆë‹¤!\n";
            }
        }
    } else {
        battleLog += "\nğŸ’€ " + player.name + "ê°€ íŒ¨ë°°í–ˆìŠµë‹ˆë‹¤.\n";
        player.hp = Math.max(1, Math.floor(player.maxHp * 0.1));  // ìµœëŒ€ HPì˜ 10%ë¡œ ë¶€í™œ
        player.gold = Math.floor(player.gold * 0.9);  // ê³¨ë“œì˜ 10% ì†ì‹¤
        battleLog += "ğŸ˜¢ íŒ¨ë°°ë¡œ ì¸í•´ ê³¨ë“œì˜ 10%ë¥¼ ìƒì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ ê³¨ë“œ: " + player.gold + "\n";
        battleLog += "ğŸ¥ " + player.name + "ëŠ” ë§ˆì„ë¡œ ê·€í™˜í•˜ì—¬ íšŒë³µí–ˆìŠµë‹ˆë‹¤. í˜„ì¬ HP: " + player.hp + "\n";
    }

    return battleLog;
}

function completeQuest(player, questTitle) {
    var quest = gameData.quests.find(function(q) { return q.title === questTitle; });
    if (quest && !player.completedQuests.includes(questTitle) && player.level >= quest.requiredLevel) {
        player.completedQuests.push(questTitle);
        player.gold += quest.rewardGold;
        gainExp(player, quest.rewardExp);
        return "ğŸ† í€˜ìŠ¤íŠ¸ '" + questTitle + "'ì„(ë¥¼) ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ë³´ìƒ: " + quest.rewardExp + " ê²½í—˜ì¹˜, " + quest.rewardGold + " ê³¨ë“œ";
    }
    return "âŒ í•´ë‹¹ í€˜ìŠ¤íŠ¸ë¥¼ ì™„ë£Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë ˆë²¨ì´ ë¶€ì¡±í•˜ê±°ë‚˜ ì´ë¯¸ ì™„ë£Œí•œ í€˜ìŠ¤íŠ¸ì…ë‹ˆë‹¤.";
}

function enhanceEquipment(player, itemName) {
    var item = player.inventory.find(i => i.name === itemName);
    if (item && item.type === "weapon" || item.type === "armor") {
        var enhanceCost = Math.floor(item.effect.price * 0.1);
        if (player.gold >= enhanceCost) {
            player.gold -= enhanceCost;
            if (item.type === "weapon") {
                item.effect.attackBoost += Math.floor(item.effect.attackBoost * 0.1);
            } else {
                item.effect.defenseBoost += Math.floor(item.effect.defenseBoost * 0.1);
            }
            return "ê°•í™” ì„±ê³µ! " + itemName + "ì˜ ì„±ëŠ¥ì´ 10% í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.";
        }
        return "ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.";
    }
    return "ê°•í™”í•  ìˆ˜ ì—†ëŠ” ì•„ì´í…œì…ë‹ˆë‹¤.";
}

function createDungeon(name, minLevel, maxLevel, stages) {
    var newDungeon = {
        name: name,
        minLevel: minLevel,
        maxLevel: maxLevel,
        stages: stages
    };
    gameData.dungeons.push(newDungeon);
    return newDungeon;
}
function enterDungeon(player, dungeonName) {
    var dungeon = gameData.dungeons.find(d => d.name === dungeonName);
    if (!dungeon) return "í•´ë‹¹ ë˜ì „ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
    if (player.level < dungeon.minLevel) {
        return "ë ˆë²¨ì´ ë¶€ì¡±í•˜ì—¬ ì…ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
    }
    var log = player.name + "ì´(ê°€) " + dungeon.name + "ì— ì…ì¥í–ˆìŠµë‹ˆë‹¤!\n";
    for (var i = 0; i < dungeon.stages.length; i++) {
        log += "\n===== " + (i+1) + "ë‹¨ê³„ =====\n";
        var result = battle(player, dungeon.stages[i], false);
        log += result;
        if (player.hp <= 0) {
            log += "\në˜ì „ íƒí—˜ ì‹¤íŒ¨...";
            return log;
        }
    }
    log += "\në˜ì „ í´ë¦¬ì–´! ì¶•í•˜í•©ë‹ˆë‹¤!";
    return log;
}

function randomEvent(player) {
    var events = [
        {name: "ë³´ë¬¼ ìƒì ë°œê²¬", effect: function(p) { p.gold += 100; return p.name + "ì´(ê°€) ë³´ë¬¼ ìƒìë¥¼ ë°œê²¬í•˜ì—¬ 100ê³¨ë“œë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤!"; }},
        {name: "í•¨ì •ì— ë¹ ì§", effect: function(p) { p.hp -= 20; return p.name + "ì´(ê°€) í•¨ì •ì— ë¹ ì ¸ 20ì˜ ë°ë¯¸ì§€ë¥¼ ì…ì—ˆìŠµë‹ˆë‹¤!"; }},
        {name: "ì‹ ë¹„í•œ ìƒ˜", effect: function(p) { p.mp += 50; return p.name + "ì´(ê°€) ì‹ ë¹„í•œ ìƒ˜ì„ ë°œê²¬í•˜ì—¬ MPê°€ 50 íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤!"; }},
        {name: "ê³ ëŒ€ì˜ ì±…", effect: function(p) { p.exp += 50; return p.name + "ì´(ê°€) ê³ ëŒ€ì˜ ì±…ì„ ì½ê³  50ì˜ ê²½í—˜ì¹˜ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤!"; }}
    ];
    var event = events[Math.floor(Math.random() * events.length)];
    return event.effect(player);
}

function response(room, msg, sender, isGroupChat, replier) {
    var commands = msg.split(" ");
    var command = commands[0];
    switch(command) {
        case "!ìºë¦­í„°ìƒì„±":
            var player = addPlayer(sender);
            replier.reply("ğŸ­ " + sender + "ë‹˜ì˜ ìºë¦­í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\në ˆë²¨: " + player.level + "\nHP: " + player.hp + "/" + player.maxHp + "\nMP: " + player.mp + "/" + player.maxMp);
            break;
            
        case "ê´€ë¦¬ì":
          var player = getPlayer(sender);
          if (player) {
            var amount = parseInt(commands[1]) || 10000000000000;  // ê¸°ë³¸ê°’ 1000
             player.gold += amount;
               replier.reply(sender + "ë‹˜ì˜ ê³¨ë“œê°€ " + amount + " ì¦ê°€í–ˆìŠµë‹ˆë‹¤. í˜„ì¬ ê³¨ë“œ: " + player.gold);
    } else {
        replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
    }
    break;
    
        case "!ìƒíƒœí™•ì¸":
            var player = getPlayer(sender);
            if (player) {
                var status = "ğŸ“Š " + sender + "ë‹˜ì˜ ìƒíƒœ:\n" +
                             "ë ˆë²¨: " + player.level + "\n" +
                             "ê²½í—˜ì¹˜: " + player.exp + "/" + (player.level * 100) + "\n" +
                             "HP: " + player.hp + "/" + player.maxHp + "\n" +
                             "MP: " + player.mp + "/" + player.maxMp + "\n" +
                             "ê³µê²©ë ¥: " + player.attack + "\n" +
                             "ë°©ì–´ë ¥: " + player.defense + "\n" +
                             "ê³¨ë“œ: " + player.gold;
                replier.reply(status);
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì „íˆ¬":
            var player = getPlayer(sender);
            if (player) {
                var enemyName = commands[1];
                if (enemyName) {
                    var result = battle(player, enemyName, false);
                    replier.reply(result);
                } else {
                    var monsters = gameData.monsters;
                    var monsterList = monsters.map(function(m) {
                        return "ğŸ¾ " + m.name + " (HP: " + m.hp + ", ê³µê²©ë ¥: " + m.attack + ")";
                    }).join("\n");
                    replier.reply("ì „íˆ¬ ê°€ëŠ¥í•œ ëª¬ìŠ¤í„° ëª©ë¡:\n" + monsterList + "\n\nì „íˆ¬í•˜ë ¤ë©´ '!ì „íˆ¬ ëª¬ìŠ¤í„°ì´ë¦„'ì„ ì…ë ¥í•˜ì„¸ìš”." + ' '.repeat(500));
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ë³´ìŠ¤ì „íˆ¬":
            var player = getPlayer(sender);
            if (player) {
                var bossName = commands.slice(1).join(" ");
                if (bossName) {
                    var result = battle(player, bossName, true);
                    replier.reply(result);
                } else {
                    var bosses = gameData.bosses;
                    var bossList = bosses.map(function(b) {
                        return "\n\n" + b.name + " (HP: " + b.hp + ", ê³µê²©ë ¥: " + b.attack + ", íŠ¹ìˆ˜ëŠ¥ë ¥: " + b.specialAbility + ")";
                    }).join("\n");
                    replier.reply("ì „íˆ¬ ê°€ëŠ¥í•œ ë³´ìŠ¤ ëª©ë¡:\n" + bossList + "\n\në³´ìŠ¤ì™€ ì „íˆ¬í•˜ë ¤ë©´ '!ë³´ìŠ¤ì „íˆ¬ ë³´ìŠ¤ì´ë¦„'ì„ ì…ë ¥í•˜ì„¸ìš”." + ' '.repeat(500));
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì•„ì´í…œêµ¬ë§¤":
            var player = getPlayer(sender);
            if (player) {
                var itemName = commands.slice(1).join(" ");
                if (itemName) {
                    var success = buyItem(player, itemName);
                    if (success) {
                        replier.reply("ğŸ›’ " + itemName + "ì„(ë¥¼) êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤.");
                    } else {
                        replier.reply("âŒ ì•„ì´í…œ êµ¬ë§¤ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê³¨ë“œê°€ ë¶€ì¡±í•˜ê±°ë‚˜ í•´ë‹¹ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤.");
                    }
                } else {
                    replier.reply("â“ êµ¬ë§¤í•  ì•„ì´í…œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì•„ì´í…œì‚¬ìš©":
            var player = getPlayer(sender);
            if (player) {
                var itemName = commands.slice(1).join(" ");
                if (itemName) {
                    var success = useItem(player, itemName);
                    if (success) {
                        replier.reply("âœ¨ " + itemName + "ì„(ë¥¼) ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.");
                    } else {
                        replier.reply("âŒ ì•„ì´í…œ ì‚¬ìš©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì•„ì´í…œì´ ì¸ë²¤í† ë¦¬ì— ì—†ìŠµë‹ˆë‹¤.");
                    }
                } else {
                    replier.reply("â“ ì‚¬ìš©í•  ì•„ì´í…œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì¥ë¹„ì¥ì°©":
            var player = getPlayer(sender);
            if (player) {
                var itemName = commands.slice(1).join(" ");
                if (itemName) {
                    var success = equipItem(player, itemName);
                    if (success) {
                        replier.reply("ğŸ›¡ï¸ " + itemName + "ì„(ë¥¼) ì¥ì°©í–ˆìŠµë‹ˆë‹¤.");
                    } else {
                        replier.reply("âŒ ì¥ë¹„ ì¥ì°©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì•„ì´í…œì´ ì¸ë²¤í† ë¦¬ì— ì—†ê±°ë‚˜ ì¥ì°©í•  ìˆ˜ ì—†ëŠ” ì•„ì´í…œì…ë‹ˆë‹¤.");
                    }
                } else {
                    replier.reply("â“ ì¥ì°©í•  ì•„ì´í…œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì¥ë¹„í•´ì œ":
            var player = getPlayer(sender);
            if (player) {
                var itemType = commands[1];
                if (itemType === "ë¬´ê¸°" || itemType === "ë°©ì–´êµ¬" || itemType === "ì•…ì„¸ì„œë¦¬") {
                    var success = unequipItem(player, itemType === "ë¬´ê¸°" ? "weapon" : itemType === "ë°©ì–´êµ¬" ? "armor" : "accessory");
                    if (success) {
                        replier.reply("ğŸ”“ " + itemType + "ë¥¼ í•´ì œí–ˆìŠµë‹ˆë‹¤.");
                    } else {
                        replier.reply("âŒ ì¥ë¹„ í•´ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¶€ìœ„ì— ì¥ì°©ëœ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.");
                    }
                } else {
                    replier.reply("â“ í•´ì œí•  ì¥ë¹„ ì¢…ë¥˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (ë¬´ê¸°, ë°©ì–´êµ¬, ë˜ëŠ” ì•…ì„¸ì„œë¦¬)");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ìŠ¤í‚¬ë°°ìš°ê¸°":
            var player = getPlayer(sender);
            if (player) {
                var skillName = commands.slice(1).join(" ");
                if (skillName) {
                    var success = learnSkill(player, skillName);
                    if (success) {
                        replier.reply("ğŸ“š " + skillName + " ìŠ¤í‚¬ì„ ë°°ì› ìŠµë‹ˆë‹¤.");
                    } else {
                        replier.reply("âŒ ìŠ¤í‚¬ ìŠµë“ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì´ë¯¸ ë°°ìš´ ìŠ¤í‚¬ì´ê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìŠ¤í‚¬ì…ë‹ˆë‹¤.");
                    }
                } else {
                    replier.reply("â“ ë°°ìš¸ ìŠ¤í‚¬ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ìƒì ":
            var items = gameData.items;
            var itemList = items.map(function(item) {
                return "\n\nğŸ·ï¸ " + item.name + " - " + item.description + " (ê°€ê²©: " + item.effect.price + "ê³¨ë“œ)";
            }).join("\n");
            replier.reply("ğŸª™ Mars Rpg ìƒì \n" + ' '.repeat(500) + "ğŸª êµ¬ë§¤ ê°€ëŠ¥í•œ ì•„ì´í…œ ëª©ë¡\n" + itemList + "\n\nêµ¬ë§¤í•˜ë ¤ë©´ '!ì•„ì´í…œêµ¬ë§¤ ì•„ì´í…œì´ë¦„'ì„ ì…ë ¥í•˜ì„¸ìš”." + ' '.repeat(500));
            break;

        case "!í€˜ìŠ¤íŠ¸ëª©ë¡":
            var quests = gameData.quests;
            var questList = quests.map(function(quest) {
                return "ğŸ“œ " + quest.title + " - " + quest.description + " (ë³´ìƒ: " + quest.rewardExp + " ê²½í—˜ì¹˜, " + quest.rewardGold + " ê³¨ë“œ, í•„ìš” ë ˆë²¨: " + quest.requiredLevel + ")";
            }).join("\n");
            replier.reply("ìˆ˜í–‰ ê°€ëŠ¥í•œ í€˜ìŠ¤íŠ¸ ëª©ë¡:\n" + questList + "\n\ní€˜ìŠ¤íŠ¸ë¥¼ ì™„ë£Œí•˜ë ¤ë©´ '!í€˜ìŠ¤íŠ¸ì™„ë£Œ í€˜ìŠ¤íŠ¸ì œëª©'ì„ ì…ë ¥í•˜ì„¸ìš”." + ' '.repeat(500));
            break;

        case "!í€˜ìŠ¤íŠ¸ì™„ë£Œ":
            var player = getPlayer(sender);
            if (player) {
                var questTitle = commands.slice(1).join(" ");
                if (questTitle) {
                    var result = completeQuest(player, questTitle);
                    replier.reply(result);
                } else {
                    replier.reply("â“ ì™„ë£Œí•  í€˜ìŠ¤íŠ¸ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ìŠ¤í‚¬ëª©ë¡":
            var player = getPlayer(sender);
            if (player) {
                var skillList = player.skills.map(function(skill) {
                    return "ğŸ”® " + skill.name + " - " + skill.description + " (MP ì†Œëª¨: " + skill.mpCost + ", ë°ë¯¸ì§€: " + skill.damage + ")";
                }).join("\n");
                replier.reply(sender + "ë‹˜ì˜ ìŠ¤í‚¬ ëª©ë¡:\n" + skillList);
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì¸ë²¤í† ë¦¬":
            var player = getPlayer(sender);
            if (player) {
                var inventoryList = player.inventory.map(function(item) {
                    return "ğŸ’ " + item.name + " - " + item.description;
                }).join("\n");
                replier.reply(sender + "ë‹˜ì˜ ì¸ë²¤í† ë¦¬:\n" + inventoryList);
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ì¥ë¹„ê°•í™”":
            var player = getPlayer(sender);
            if (player) {
                var itemName = commands.slice(1).join(" ");
                if (itemName) {
                    var result = enhanceEquipment(player, itemName);
                    replier.reply(result);
                } else {
                    replier.reply("â“ ê°•í™”í•  ì¥ë¹„ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ë˜ì „ì…ì¥":
            var player = getPlayer(sender);
            if (player) {
                var dungeonName = commands.slice(1).join(" ");
                if (dungeonName) {
                    var result = enterDungeon(player, dungeonName);
                    replier.reply(result);
                } else {
function enterDungeon(player, dungeonName) {
    var dungeon = gameData.dungeons.find(d => d.name === dungeonName);
    if (!dungeon) return "í•´ë‹¹ ë˜ì „ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
    if (player.level < dungeon.minLevel) {
        return "ë ˆë²¨ì´ ë¶€ì¡±í•˜ì—¬ ì…ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
    }
    var log = player.name + "ì´(ê°€) " + dungeon.name + "ì— ì…ì¥í–ˆìŠµë‹ˆë‹¤!\n";
    for (var i = 0; i < dungeon.stages.length; i++) {
        log += "\n===== " + (i+1) + "ë‹¨ê³„ =====\n";
        var result = battle(player, dungeon.stages[i], false);
        log += result;
        if (player.hp <= 0) {
            log += "\në˜ì „ íƒí—˜ ì‹¤íŒ¨...";
            return log;
        }
    }
    log += "\në˜ì „ í´ë¦¬ì–´! ì¶•í•˜í•©ë‹ˆë‹¤!";
    return log;
}

function randomEvent(player) {
    var events = [
        {name: "ë³´ë¬¼ ìƒì ë°œê²¬", effect: function(p) { p.gold += 100; return p.name + "ì´(ê°€) ë³´ë¬¼ ìƒìë¥¼ ë°œê²¬í•˜ì—¬ 100ê³¨ë“œë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤!"; }},
        {name: "í•¨ì •ì— ë¹ ì§", effect: function(p) { p.hp -= 20; return p.name + "ì´(ê°€) í•¨ì •ì— ë¹ ì ¸ 20ì˜ ë°ë¯¸ì§€ë¥¼ ì…ì—ˆìŠµë‹ˆë‹¤!"; }},
        {name: "ì‹ ë¹„í•œ ìƒ˜", effect: function(p) { p.mp += 50; return p.name + "ì´(ê°€) ì‹ ë¹„í•œ ìƒ˜ì„ ë°œê²¬í•˜ì—¬ MPê°€ 50 íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤!"; }},
        {name: "ê³ ëŒ€ì˜ ì±…", effect: function(p) { p.exp += 50; return p.name + "ì´(ê°€) ê³ ëŒ€ì˜ ì±…ì„ ì½ê³  50ì˜ ê²½í—˜ì¹˜ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤!"; }}
    ];
    var event = events[Math.floor(Math.random() * events.length)];
    return event.effect(player);
}
                    var dungeonList = gameData.dungeons.map(function(d) {
                        return "ğŸ° " + d.name + " (í•„ìš” ë ˆë²¨: " + d.minLevel + " ~ " + d.maxLevel + ")";
                    }).join("\n");
                    replier.reply("ì…ì¥ ê°€ëŠ¥í•œ ë˜ì „ ëª©ë¡:\n" + dungeonList + "\n\në˜ì „ì— ì…ì¥í•˜ë ¤ë©´ '!ë˜ì „ì…ì¥ ë˜ì „ì´ë¦„'ì„ ì…ë ¥í•˜ì„¸ìš”." + ' '.repeat(500));
                }
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!ëœë¤ì´ë²¤íŠ¸":
            var player = getPlayer(sender);
            if (player) {
                var eventResult = randomEvent(player);
                replier.reply(eventResult);
            } else {
                replier.reply("âŒ ìºë¦­í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");
            }
            break;

        case "!RPGë„ì›€ë§":
            var helpText = "âš” Mars Rpg ëª…ë ¹ì–´" + " ".repeat(500)+
                           "\n!ìºë¦­í„°ìƒì„± - ìƒˆ ìºë¦­í„° ìƒì„±\n" +
                           "!ìƒíƒœí™•ì¸ - ìºë¦­í„° ìƒíƒœ í™•ì¸\n" +
                           "!ì „íˆ¬ [ëª¬ìŠ¤í„°ì´ë¦„] - ëª¬ìŠ¤í„°ì™€ ì „íˆ¬\n" +
                           "!ë³´ìŠ¤ì „íˆ¬ [ë³´ìŠ¤ì´ë¦„] - ë³´ìŠ¤ì™€ ì „íˆ¬\n" +
                           "!ìƒì  - ì•„ì´í…œ êµ¬ë§¤\n" +
                           "!ì•„ì´í…œêµ¬ë§¤ [ì•„ì´í…œì´ë¦„] - ì•„ì´í…œ êµ¬ë§¤\n" +
                           "!ì•„ì´í…œì‚¬ìš© [ì•„ì´í…œì´ë¦„] - ì•„ì´í…œ ì‚¬ìš©\n" +
                           "!ì¥ë¹„ì¥ì°© [ì•„ì´í…œì´ë¦„] - ì¥ë¹„ ì¥ì°©\n" +
                           "!ì¥ë¹„í•´ì œ [ë¬´ê¸°/ë°©ì–´êµ¬/ì•…ì„¸ì„œë¦¬] - ì¥ë¹„ í•´ì œ\n" +
                           "!ìŠ¤í‚¬ë°°ìš°ê¸° [ìŠ¤í‚¬ì´ë¦„] - ìƒˆë¡œìš´ ìŠ¤í‚¬ ìŠµë“\n" +
                           "!í€˜ìŠ¤íŠ¸ëª©ë¡ - ìˆ˜í–‰ ê°€ëŠ¥í•œ í€˜ìŠ¤íŠ¸ í™•ì¸\n" +
                           "!í€˜ìŠ¤íŠ¸ì™„ë£Œ [í€˜ìŠ¤íŠ¸ì œëª©] - í€˜ìŠ¤íŠ¸ ì™„ë£Œ\n" +
                           "!ìŠ¤í‚¬ëª©ë¡ - ë³´ìœ í•œ ìŠ¤í‚¬ í™•ì¸\n" +
                           "!ì¸ë²¤í† ë¦¬ - ë³´ìœ í•œ ì•„ì´í…œ í™•ì¸\n" +
                           "!ì¥ë¹„ê°•í™” [ì•„ì´í…œì´ë¦„] - ì¥ë¹„ ê°•í™”\n" +
                           "!ë˜ì „ì…ì¥ [ë˜ì „ì´ë¦„] - ë˜ì „ ì…ì¥\n" +
                           "!ëœë¤ì´ë²¤íŠ¸ - ëœë¤ ì´ë²¤íŠ¸ ë°œìƒ";
            replier.reply(helpText);
            break;

        }
}

// ì´ˆê¸° ì•„ì´í…œ, ëª¬ìŠ¤í„°, ë³´ìŠ¤, í€˜ìŠ¤íŠ¸, ìŠ¤í‚¬ ì¶”ê°€
addItem("ì†Œí˜• ì²´ë ¥ í¬ì…˜", "HPë¥¼ 30 íšŒë³µí•©ë‹ˆë‹¤.\n\n", { heal: 30, price: 30 });
addItem("ì¤‘í˜• ì²´ë ¥ í¬ì…˜", "HPë¥¼ 70 íšŒë³µí•©ë‹ˆë‹¤.\n\n", { heal: 70, price: 70 });
addItem("ëŒ€í˜• ì²´ë ¥ í¬ì…˜", "HPë¥¼ 150 íšŒë³µí•©ë‹ˆë‹¤.\n\n", { heal: 150, price: 150 });
addItem("ì†Œí˜• ë§ˆë‚˜ í¬ì…˜", "MPë¥¼ 20 íšŒë³µí•©ë‹ˆë‹¤.\n\n", { mpRestore: 20, price: 25 });
addItem("ì¤‘í˜• ë§ˆë‚˜ í¬ì…˜", "MPë¥¼ 50 íšŒë³µí•©ë‹ˆë‹¤.\n\n", { mpRestore: 50, price: 60 });
addItem("ëŒ€í˜• ë§ˆë‚˜ í¬ì…˜", "MPë¥¼ 100 íšŒë³µí•©ë‹ˆë‹¤.\n\n", { mpRestore: 100, price: 120 });

// ê·¼ì ‘ ë¬´ê¸°
addItem("ì²­ë™ ë‹¨ê²€", "ê¸°ë³¸ì ì¸ ë‹¨ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 8, price: 150, type: "weapon" });
addItem("ê°•ì²  ì¥ê²€", "í‘œì¤€ì ì¸ ì¥ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 15, price: 300, type: "weapon" });
addItem("ë¯¸ìŠ¤ë¦´ ëŒ€ê²€", "ê°€ë³ê³  ê°•í•œ ëŒ€ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 91, price: 100, type: "weapon" });
addItem("ë¶ˆê½ƒì˜ ë„ë¼", "í™”ì—¼ ì†ì„±ì´ ë¶€ì—¬ëœ ë„ë¼ì…ë‹ˆë‹¤.\n\n", { attackBoost: 61, fireBoost: 10, price: 800, type: "weapon" });
addItem("ì–¼ìŒ ì°½", "ì–¼ìŒ ì†ì„±ì´ ë¶€ì—¬ëœ ì°½ì…ë‹ˆë‹¤.\n\n", { attackBoost: 76, iceBoost: 12, price: 100, type: "weapon" });
addItem("ë²ˆê°œì˜ ë§ì¹˜", "ë²ˆê°œ ì†ì„±ì´ ë¶€ì—¬ëœ ë§ì¹˜ì…ë‹ˆë‹¤.\n\n", { attackBoost: 100, thunderBoost: 15, price: 250, type: "weapon" });
addItem("ì´ê±° ì‚¬ì„¸ìš”.", "í¼ì£¼ëŠ”ê²€.\n\n", { attackBoost: 1000, thunderBoost: 150, price: 2500, type: "weapon" });

// ì›ê±°ë¦¬ ë¬´ê¸°
addItem("ë‹¨ê¶", "ê¸°ë³¸ì ì¸ í™œì…ë‹ˆë‹¤.\n\n", { attackBoost: 10, price: 200, type: "weapon" });
addItem("ì¥ê¶", "ì‚¬ê±°ë¦¬ê°€ ê¸´ í™œì…ë‹ˆë‹¤.\n\n", { attackBoost: 18, price: 400, type: "weapon" });
addItem("í¬ë¡œìŠ¤ë³´ìš°", "ê°•ë ¥í•œ ê´€í†µë ¥ì„ ê°€ì§„ ë¬´ê¸°ì…ë‹ˆë‹¤.\n\n", { attackBoost: 22, price: 500, type: "weapon" });
addItem("ë§ˆë²• ì§€íŒ¡ì´", "ë§ˆë²• ê³µê²©ë ¥ì„ ë†’ì—¬ì£¼ëŠ” ì§€íŒ¡ì´ì…ë‹ˆë‹¤.\n\n", { attackBoost: 12, magicBoost: 20, price: 600, type: "weapon" });
addItem("í˜„ìì˜ ì˜¤ë¸Œ", "ë§ˆë²• íš¨ê³¼ë¥¼ ì¦í­ì‹œí‚¤ëŠ” ì˜¤ë¸Œì…ë‹ˆë‹¤.\n\n", { attackBoost: 8, magicBoost: 30, price: 700, type: "weapon" });

// ì „ì„¤ê¸‰ ë¬´ê¸°
addItem("ì—‘ìŠ¤ì¹¼ë¦¬ë²„", "ì „ì„¤ì˜ ì„±ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 500, holyBoost: 30, price: 900, type: "weapon" });
addItem("ê¶ë‹ˆë¥´", "ì‹ ì˜ ì°½ì…ë‹ˆë‹¤.\n\n", { attackBoost: 5500, thunderBoost: 25, price: 6500, type: "weapon" });
addItem("ë¯¸ìšœë‹ˆë¥´", "ë²ˆê°œì˜ ì‹  í† ë¥´ì˜ ë§ì¹˜ì…ë‹ˆë‹¤.\n\n", { attackBoost: 600, thunderBoost: 40, price: 1700, type: "weapon" });
addItem("ë¬´í•œì˜ ê²€", "ì°¨ì›ì„ ê°€ë¥´ëŠ” ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 700, price: 2000, type: "weapon" });
addItem("í”¼ì˜ ê²€", "í”¼ë¡œ ì ì„ ë’¤ë®ìŠµë‹ˆë‹¤.\n\n", { attackBoost: 20000, demonSlayer: 10200, price: 12000, type: "weapon" });

// íŠ¹ìˆ˜ ë¬´ê¸°
addItem("í¡í˜ˆì˜ ë‹¨ê²€", "ì ì˜ í”¼ë¥¼ í¡ìˆ˜í•˜ëŠ” ë‹¨ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 2000, lifeSteal: 10, price: 3500, type: "weapon" });
addItem("ë…ì‚¬ì˜ í™œ", "ë… ì†ì„±ì´ ë¶€ì—¬ëœ í™œì…ë‹ˆë‹¤.\n\n", { attackBoost: 2500, poisonBoost: 15, price: 1600, type: "weapon" });
addItem("ê·¸ë¦¼ì ë‹¨ë„", "ì€ì‹  ëŠ¥ë ¥ì„ ë¶€ì—¬í•˜ëŠ” ë‹¨ë„ì…ë‹ˆë‹¤.\n\n", { attackBoost: 2200, stealthBoost: 20, price: 3700, type: "weapon" });
addItem("ìš©ì‚¬ì˜ ëŒ€ê²€", "ìš©ì¡±ì—ê²Œ ì¶”ê°€ ë°ë¯¸ì§€ë¥¼ ì£¼ëŠ” ëŒ€ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 3500, dragonSlayer: 50, price: 5000, type: "weapon" });
addItem("ì•…ë§ˆ í‡´ì¹˜ì˜ í™€ë¦¬ì›Œí„°", "ì•…ë§ˆì¡±ì—ê²Œ ì¶”ê°€ ë°ë¯¸ì§€ë¥¼ ì£¼ëŠ” ì„±ìˆ˜ì…ë‹ˆë‹¤.\n\n", { attackBoost: 1500, holyBoost: 40, demonSlayer: 60, price: 2800, type: "weapon" });
addItem("ëŒ€ì™•ì¡± ë¬´ê¸°", "ëŒ€ì™•ì¡±ì˜ ìœ„ëŒ€í•œ ë¬´ê¸°ì…ë‹ˆë‹¤.\n\n", { attackBoost: 7822192, holyBoost: 600, demonSlayer: 600, price: 28000, type: "weapon" });

// ì§ì—…ë³„ íŠ¹ìˆ˜ ë¬´ê¸°
addItem("ì•”ì‚´ìì˜ ìŒê²€", "ì•”ì‚´ì ì „ìš© ìŒê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 400, criticalBoost: 20, price: 500, type: "weapon", class: "assassin" });
addItem("ì„±ê¸°ì‚¬ì˜ ì„±ê²€", "ì„±ê¸°ì‚¬ ì „ìš© ì„±ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 450, holyBoost: 25, defenseBoost: 15, price: 500, type: "weapon", class: "paladin" });
addItem("ëŒ€ë§ˆë²•ì‚¬ì˜ ì§€íŒ¡ì´", "ëŒ€ë§ˆë²•ì‚¬ ì „ìš© ì§€íŒ¡ì´ì…ë‹ˆë‹¤.\n\n", { attackBoost: 200, magicBoost: 50, mpBoost: 100, price: 320, type: "weapon", class: "archmage" });
addItem("ë ˆì¸ì €ì˜ ì¥ê¶", "ë ˆì¸ì € ì „ìš© ì¥ê¶ì…ë‹ˆë‹¤.\n\n", { attackBoost: 420, rangeBoost: 30, criticalBoost: 15, price: 600, type: "weapon", class: "ranger" });
addItem("ë²„ì„œì»¤ì˜ ëŒ€ë„", "ë²„ì„œì»¤ ì „ìš© ëŒ€ë„ì…ë‹ˆë‹¤.\n\n", { attackBoost: 550, rageBoost: 25, price: 500, type: "weapon", class: "berserker" });

// ì´ˆê°•ë ¥ ë¬´ê¸° ì¶”ê°€
addItem("ì²œìƒì˜ ì‹¬íŒì", "ì‹ ë“¤ì˜ í˜ì´ ê¹ƒë“  ì „ì„¤ì˜ ëŒ€ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 150000, holyBoost: 10000, criticalBoost: 300, price: 500000, type: "weapon" });
addItem("í˜¼ëˆì˜ íŒŒê´´ì", "ì„¸ê³„ì˜ ì¢…ë§ì„ ë¶€ë¥´ëŠ” ì €ì£¼ë°›ì€ ë„ë¼ì…ë‹ˆë‹¤.\n\n", { attackBoost: 180000, chaosBoost: 12000, lifeSteal: 20, price: 550000, type: "weapon" });
addItem("ìš°ì£¼ì˜ ì§€ë°°ì", "ì€í•˜ê³„ì˜ í˜ì„ ë‹¤ë£¨ëŠ” ì§€íŒ¡ì´ì…ë‹ˆë‹¤.\n\n", { attackBoost: 100000, magicBoost: 20000, mpBoost: 5000, price: 600000, type: "weapon" });
addItem("ì‹œê³µê°„ì˜ ì™œê³¡ì", "í˜„ì‹¤ì„ ë’¤í‹€ ìˆ˜ ìˆëŠ” ì‹ ë¹„í•œ ë‹¨ê²€ì…ë‹ˆë‹¤.\n\n", { attackBoost: 130000, stealthBoost: 10000, timeWarpBoost: 500, price: 580000, type: "weapon" });
addItem("ì ˆëŒ€ìì˜ í™œ", "ëª¨ë“  ê²ƒì„ ê¿°ëš«ëŠ” ì‹ ì„±í•œ í™œì…ë‹ˆë‹¤.\n\n", { attackBoost: 160000, pierceBoost: 10050, rangeBoost: 1000, price: 570000, type: "weapon" });

// ì´ˆê°•ë ¥ ë³´ìŠ¤ ì¶”ê°€
addBoss("ì„¸ê³„ìˆ˜ ì´ê·¸ë“œë¼ì‹¤", 1000000, 30000, 20000, 1000000, 10000000, "ìƒëª…ì˜ ê·¼ì›", { name: "ì„¸ê³„ì˜ ì”¨ì•—", attackBoost: 200000, defenseBoost: 1500, type: "accessory" });
addBoss("í˜¼ëˆì˜ ì‹  í‹°ì•„ë§ˆíŠ¸", 1200000, 35000, 18000, 1200000, 12000000, "ì›ì´ˆì˜ í˜¼ëˆ", { name: "í˜¼ëˆì˜ ë¹„ëŠ˜", attackBoost: 200050, chaosBoost: 2000, type: "armor" });
addBoss("ì²œìƒì˜ ì‹¬íŒì ë©”íƒ€íŠ¸ë¡ ", 1100000, 40000, 25000, 11000, 110000, "ì²œë²Œ", { name: "ì²œìƒì˜ ë‚ ê°œ", holyBoost: 300000, mpBoost: 10000, type: "accessory" });
addBoss("ì‹¬ì—°ì˜ ì§€ë°°ì í¬íˆ´ë£¨", 1500000, 5000, 15000, 1500000, 150000, "ê´‘ê¸°ì˜ ì†ì‚­ì„", { name: "ì‹¬ì—°ì˜ ëˆˆ", magicBoost: 400000, sanityDrain: 500, type: "accessory" });
addBoss("ì‹œê³µê°„ì˜ ì§€ë°°ì í¬ë¡œë…¸ìŠ¤", 1300000, 45000, 22000, 13000, 130000, "ì‹œê°„ ì •ì§€", { name: "ì‹œê°„ì˜ ëª¨ë˜ì‹œê³„", timeWarpBoost: 250000, attackBoost: 2000, type: "accessory" });

// ë°©ì–´êµ¬
addItem("ê°€ì£½ ê°‘ì˜·", "ë°©ì–´ë ¥ì„ 3 ì¦ê°€ì‹œí‚µë‹ˆë‹¤.\n\n", { defenseBoost: 10, price: 80, type: "armor" });
addItem("ì²  ê°‘ì˜·", "ë°©ì–´ë ¥ì„ 8 ì¦ê°€ì‹œí‚µë‹ˆë‹¤.\n\n", { defenseBoost: 15, price: 200, type: "armor" });
addItem("ë¯¸ìŠ¤ë¦´ ê°‘ì˜·", "ë°©ì–´ë ¥ì„ 15 ì¦ê°€ì‹œí‚µë‹ˆë‹¤.\n\n", { defenseBoost: 200, price: 500, type: "armor" });

addMonster("ìŠ¬ë¼ì„", 40, 5, 2, 20, 10);
addMonster("ê³ ë¸”ë¦°", 60, 8, 3, 35, 20);
addMonster("ì˜¤í¬", 100, 12, 5, 60, 35);
addMonster("íŠ¸ë¡¤", 150, 18, 8, 90, 55);
addMonster("ëŠ‘ëŒ€", 70, 10, 4, 40, 25);
addMonster("ìŠ¤ì¼ˆë ˆí†¤", 80, 11, 3, 45, 30);
addMonster("ì¢€ë¹„", 100, 9, 6, 50, 35);
addMonster("ë°´ì‹œ", 310, 15, 4, 65, 40);
addMonster("í•˜í”¼", 620, 16, 5, 70, 45);
addMonster("ë¯¸ë…¸íƒ€ìš°ë¥´ìŠ¤", 1080, 20, 10, 100, 70);
/**
hp, att, ?, xp, gold
**/
addBoss("ë“œë˜ê³¤", 10000, 500, 300, 5000, 10000, "í™”ì—¼ ë¸Œë ˆìŠ¤", { name: "ë“œë˜ê³¤ ìŠ¬ë ˆì´ì–´", attackBoost: 5000, type: "weapon" });
addBoss("ë°ëª¬ ë¡œë“œ", 20000, 800, 500, 1000, 20000, "ì–´ë‘ ì˜ ì €ì£¼", { name: "ë°ëª¬ ë¸”ë ˆì´ë“œ", attackBoost: 7000, type: "weapon" });
addBoss("ì‹¬ì—°ì— ê¸¸ë“¤ì–´ì§„ ê´´", 60000, 600, 400, 700, 15000, "ì´‰ìˆ˜ íœ˜ê°ê¸°", { name: "ê¹Šì€ ë°”ë‹¤ì˜ ì‚¼ì§€ì°½", attackBoost: 6000, type: "weapon" });
addBoss("ë¶€í™œì", 55000, 550, 3005, 6000, 13000, "ë¶€í™œì˜ ë¶ˆê½ƒ", { name: "ë¶ˆì‚¬ì¡°ì˜ ê¹ƒí„¸ ì§€íŒ¡ì´", attackBoost: 5500, type: "weapon" });
addBoss("íˆë“œë¼", 75000, 700, 450, 900, 18000, "ë‹¤ì¤‘ ê³µê²©", { name: "íˆë“œë¼ì˜ ë… ê²€", attackBoost: 6500, type: "weapon" });
addBoss("ì•…ì— ë¬¼ë“¤ì–´ì§„ ì", 100000, 898, 910, 780, 100000, "í”¼ë¥¼ ë‹¤ìŠ¤ë¦¬ë‹¤.", { name: "ë¶‰ì€ ê²€", attackBoost: 500000, type: "weapon" });
addBoss("ë§ˆìŠ¤ë´‡", 100000000000, 50000000000, 3000000, 5000000000, 100000000000, "í–‰ì„± ê³µê²©", { name: "ì‹ ì˜ ê¶Œë ¥", attackBoost: 5000000092329299192910, type: "weapon" });


addQuest("ìŠ¬ë¼ì„ í‡´ì¹˜", "ìŠ¬ë¼ì„ 5ë§ˆë¦¬ í‡´ì¹˜í•˜ê¸°", 100, 50, 1, 5);
addQuest("ê³ ë¸”ë¦° ì†Œíƒ•", "ê³ ë¸”ë¦° 10ë§ˆë¦¬ ì²˜ì¹˜í•˜ê¸°", 200, 100, 3, 10);
addQuest("ì˜¤í¬ ìš°ë‘ë¨¸ë¦¬ ì²˜ì¹˜", "ì˜¤í¬ ìš°ë‘ë¨¸ë¦¬ ì²˜ì¹˜í•˜ê¸°", 300, 200, 5, 1);
addQuest("íŠ¸ë¡¤ ë™êµ´ íƒí—˜", "íŠ¸ë¡¤ 5ë§ˆë¦¬ ì²˜ì¹˜í•˜ê¸°", 400, 300, 7, 5);
addQuest("ëŠ‘ëŒ€ ë¬´ë¦¬ í‡´ì¹˜", "ëŠ‘ëŒ€ 15ë§ˆë¦¬ ì²˜ì¹˜í•˜ê¸°", 250, 150, 4, 15);

addSkill("íŒŒì´ì–´ë³¼", "í™”ì—¼ ê³µê²©ì„ ê°€í•©ë‹ˆë‹¤.", 20, 30, "magic");
addSkill("ì•„ì´ìŠ¤ ë¸”ë¼ìŠ¤íŠ¸", "ì–¼ìŒ ê³µê²©ì„ ê°€í•©ë‹ˆë‹¤.", 25, 35, "magic");
addSkill("í", "HPë¥¼ íšŒë³µí•©ë‹ˆë‹¤.", 30, -50, "heal");
addSkill("ë²ˆê°œ ì¼ê²©", "ê°•ë ¥í•œ ë²ˆê°œ ê³µê²©ì„ ê°€í•©ë‹ˆë‹¤.", 40, 60, "magic");

createDungeon("ê³ ë¸”ë¦° ì†Œêµ´", 1, 5, ["ê³ ë¸”ë¦°", "ê³ ë¸”ë¦°", "ê³ ë¸”ë¦° ëŒ€ì¥"]);
createDungeon("ì˜¤í¬ ìš”ìƒˆ", 5, 10, ["ì˜¤í¬", "ì˜¤í¬", "ì˜¤í¬ ì „ì‚¬", "ì˜¤í¬ ëŒ€ì¥"]);
createDungeon("ë“œë˜ê³¤ì˜ ë‘¥ì§€", 15, 20, ["í•˜í”¼", "íŠ¸ë¡¤", "ë¯¸ë…¸íƒ€ìš°ë¥´ìŠ¤", "ë“œë˜ê³¤"]);

// ì´ˆì›”ì  ë¬´ê¸° ì¶”ê°€
addItem("ì°½ì¡°ì™€ íŒŒê´´ì˜ ê¶ŒëŠ¥", "ìš°ì£¼ì˜ ì„­ë¦¬ë¥¼ ì¡°ì¢…í•˜ëŠ” ì „ì§€ì „ëŠ¥í•œ í˜ì…ë‹ˆë‹¤.\n\n", {
    attackBoost: 100000,
    allStatsBoost: 50000,
    realityWarp: 10000,
    price: 100000,
    type: "weapon",
    description: "ëª¨ë“  ê³µê²©ì´ í•„ì¤‘. ì ì˜ ë°©ì–´ë ¥ ë¬´ì‹œ. ë§¤ í„´ ìµœëŒ€ HPì˜ 10% íšŒë³µ."
});

addItem("ë¬´í•œì˜ ì œì–´ë´‰", "ë¬´í•œí•œ ì—ë„ˆì§€ë¥¼ ì œì–´í•˜ëŠ” ì‹ ì˜ ë„êµ¬ì…ë‹ˆë‹¤.\n\n", {
    attackBoost: 80000,
    magicBoost: 120000,
    infiniteEnergy: true,
    price: 950000,
    type: "weapon",
    description: "MP ì†Œëª¨ ì—†ìŒ. ëª¨ë“  ë§ˆë²• ê³µê²©ë ¥ 3ë°° ì¦ê°€. ì  ê³µê²© 25% í™•ë¥ ë¡œ ë¬´íš¨í™”."
});

addItem("ìš´ëª…ì˜ ì‹¤ ê°€ìœ„", "ìƒëª…ì˜ ì‹¤ì„ ìë¥´ëŠ” ìš´ëª…ì˜ ë„êµ¬ì…ë‹ˆë‹¤.\n\n", {
    attackBoost: 1500000,
    instantKill: 1000,
    price: 1100000,
    type: "weapon",
    description: "ë§¤ ê³µê²©ì‹œ 10% í™•ë¥ ë¡œ ì  ì¦‰ì‚¬. í¬ë¦¬í‹°ì»¬ í™•ë¥  50% ì¦ê°€."
});

// ì´ˆì›”ì  ë³´ìŠ¤ ì¶”ê°€
addBoss("ì ˆëŒ€ì‹  ì˜¤ë¯€ë‹ˆí¬í…ìŠ¤", 1000000, 10000, 5000, 1000000, 10000000, "í˜„ì‹¤ ì™œê³¡", {
    name: "ì „ì§€ì „ëŠ¥ì˜ ì™•ê´€",
    allStatsBoost: 1000,
    realityManipulation: 100,
    type: "accessory",
    description: "ì°©ìš©ìì˜ ëª¨ë“  ëŠ¥ë ¥ì¹˜ 1000 ì¦ê°€. í˜„ì‹¤ ì¡°ì‘ ëŠ¥ë ¥ ë¶€ì—¬."
});

addBoss("í˜¼ëˆì˜ ì›ì´ˆì‹  ì•„ë¸Œì¡°ìŠ¤", 1500000, 15000, 3000, 1500000, 15000000, "ë¬´í•œ ì¦ì‹", {
    name: "í˜¼ëˆì˜ ì‹¬ì¥",
    attackBoost: 2000,
    regeneration: 100000,
    type: "accessory",
    description: "ë§¤ í„´ë§ˆë‹¤ 10ë§Œì˜ ì²´ë ¥ íšŒë³µ. ëª¨ë“  ê³µê²©ì´ ë²”ìœ„ ê³µê²©ìœ¼ë¡œ ë³€ê²½."
});

addBoss("ì‹œê³µê°„ì˜ ì ˆëŒ€ì ì—í…Œë¥´ëˆ„ìŠ¤", 1200000, 12000, 4000, 1200000, 12000000, "ì‹œê³µê°„ ë¶•ê´´", {
    name: "ì˜ì›ì˜ ëª¨ë˜ì‹œê³„",
    timeManipulation: 100,
    dodgeChance: 50,
    type: "accessory",
    description: "50% í™•ë¥ ë¡œ ëª¨ë“  ê³µê²© íšŒí”¼. ê°€ë” ì ì˜ í„´ì„ ì™„ì „íˆ ì‚­ì œ."
});

// ë³´ìŠ¤ ì „ìš© íŠ¹ìˆ˜ ëŠ¥ë ¥ ê°•í™”
function useBossSpecialAbility(boss, player) {
    switch(boss.name) {
        case "ì ˆëŒ€ì‹  ì˜¤ë¯€ë‹ˆí¬í…ìŠ¤":
            player.maxHp /= 2;
            player.hp = Math.min(player.hp, player.maxHp);
            return "ì˜¤ë¯€ë‹ˆí¬í…ìŠ¤ê°€ í˜„ì‹¤ì„ ì™œê³¡í–ˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ìµœëŒ€ ì²´ë ¥ì´ ì ˆë°˜ìœ¼ë¡œ ì¤„ì—ˆìŠµë‹ˆë‹¤!";
        case "í˜¼ëˆì˜ ì›ì´ˆì‹  ì•„ë¸Œì¡°ìŠ¤":
            boss.hp += 500000;
            return "ì•„ë¸Œì¡°ìŠ¤ê°€ ë¬´í•œ ì¦ì‹ì„ ì‹œì „í–ˆìŠµë‹ˆë‹¤. ì²´ë ¥ì´ 50ë§Œ ì¦ê°€í•˜ê³  ë‹¹ì‹ ì—ê²Œ ê´‘ì—­ ê³µê²©ì„ ê°€í•©ë‹ˆë‹¤!";
        case "ì‹œê³µê°„ì˜ ì ˆëŒ€ì ì—í…Œë¥´ëˆ„ìŠ¤":
            return "ì—í…Œë¥´ëˆ„ìŠ¤ê°€ ì‹œê³µê°„ì„ ë¶•ê´´ì‹œì¼°ìŠµë‹ˆë‹¤. ë‹¤ìŒ 3í„´ ë™ì•ˆ í–‰ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!";
        case "ì„¸ê³„ìˆ˜ ì´ê·¸ë“œë¼ì‹¤":
            return "ì„¸ê³„ìˆ˜ ì´ê·¸ë“œë¼ì‹¤ì´ ìƒëª…ì˜ ê·¼ì›ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ëª¨ë“  ìŠ¤íƒ¯ì´ 10% ì¦ê°€í•©ë‹ˆë‹¤.";
        case "í˜¼ëˆì˜ ì‹  í‹°ì•„ë§ˆíŠ¸":
            player.attack *= 0.8;
            player.defense *= 0.8;
            return "í‹°ì•„ë§ˆíŠ¸ê°€ ì›ì´ˆì˜ í˜¼ëˆì„ ì¼ìœ¼ì¼°ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ê³µê²©ë ¥ê³¼ ë°©ì–´ë ¥ì´ 20% ê°ì†Œí–ˆìŠµë‹ˆë‹¤.";
        case "ì²œìƒì˜ ì‹¬íŒì ë©”íƒ€íŠ¸ë¡ ":
            player.hp -= Math.floor(player.maxHp * 0.3);
            return "ë©”íƒ€íŠ¸ë¡ ì´ ì²œë²Œì„ ë‚´ë ¸ìŠµë‹ˆë‹¤. ìµœëŒ€ ì²´ë ¥ì˜ 30%ì— í•´ë‹¹í•˜ëŠ” " + Math.floor(player.maxHp * 0.3) + "ì˜ í”¼í•´ë¥¼ ì…ì—ˆìŠµë‹ˆë‹¤.";
        case "ì‹¬ì—°ì˜ ì§€ë°°ì í¬íˆ´ë£¨":
            player.mp = 0;
            return "í¬íˆ´ë£¨ì˜ ê´‘ê¸°ì˜ ì†ì‚­ì„ì´ ë‹¹ì‹ ì˜ ì •ì‹ ì„ ì¹¨ì‹í–ˆìŠµë‹ˆë‹¤. MPê°€ 0ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.";
        case "ì‹œê³µê°„ì˜ ì§€ë°°ì í¬ë¡œë…¸ìŠ¤":
            return "í¬ë¡œë…¸ìŠ¤ê°€ ì‹œê°„ì„ ì •ì§€ì‹œì¼°ìŠµë‹ˆë‹¤. ë‹¤ìŒ í„´ì— í–‰ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        default:
            return boss.name + "ì´(ê°€) " + boss.specialAbility + "ì„(ë¥¼) ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.";
    }
}
